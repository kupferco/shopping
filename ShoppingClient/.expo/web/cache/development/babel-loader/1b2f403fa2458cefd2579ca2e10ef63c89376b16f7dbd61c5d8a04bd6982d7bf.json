{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport React, { useRef, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Webcam from 'react-webcam';\nimport axios from 'axios';\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nvar WebCameraCapture = function WebCameraCapture() {\n  var webcamRef = useRef(null);\n  var containerRef = useRef(null);\n  var flashOpacity = useRef(new Animated.Value(0)).current;\n  var uploadImage = function () {\n    var _ref = _asyncToGenerator(function* (base64Image) {\n      try {\n        var response = yield axios.post('http://localhost:8080/api/price-tag/ocr', {\n          imageBase64: base64Image.split(',')[1],\n          storeId: 'your-store-id-here'\n        });\n        console.log('Upload response:', response.data);\n      } catch (error) {\n        console.error('Image upload error:', error);\n      }\n    });\n    return function uploadImage(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  useEffect(function () {\n    var container = containerRef.current;\n    var handleClick = function handleClick(event) {\n      event.preventDefault();\n      if (webcamRef.current) {\n        var imageSrc = webcamRef.current.getScreenshot();\n        if (imageSrc) {\n          uploadImage(imageSrc);\n          Animated.sequence([Animated.timing(flashOpacity, {\n            toValue: 1,\n            duration: 250,\n            useNativeDriver: true\n          }), Animated.timing(flashOpacity, {\n            toValue: 0,\n            duration: 250,\n            useNativeDriver: true\n          })]).start();\n        }\n      }\n    };\n    var containerElement = containerRef.current;\n    containerElement == null ? void 0 : containerElement.addEventListener('click', handleClick);\n    return function () {\n      containerElement == null ? void 0 : containerElement.removeEventListener('click', handleClick);\n    };\n  }, []);\n  return _jsxs(View, {\n    ref: containerRef,\n    style: styles.container,\n    children: [_jsx(Webcam, {\n      audio: false,\n      ref: webcamRef,\n      screenshotFormat: \"image/jpeg\",\n      videoConstraints: {\n        facingMode: \"environment\",\n        width: {\n          ideal: Dimensions.get('window').height\n        },\n        height: {\n          ideal: Dimensions.get('window').width\n        }\n      },\n      style: styles.webcam\n    }), _jsx(Animated.View, {\n      style: [styles.flashOverlay, {\n        opacity: flashOpacity\n      }]\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    position: 'relative'\n  },\n  webcam: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'cover'\n  },\n  flashOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'white',\n    zIndex: 10\n  }\n});\nexport default WebCameraCapture;","map":{"version":3,"names":["React","useRef","useEffect","View","Animated","StyleSheet","Dimensions","Webcam","axios","jsx","_jsx","jsxs","_jsxs","WebCameraCapture","webcamRef","containerRef","flashOpacity","Value","current","uploadImage","_ref","_asyncToGenerator","base64Image","response","post","imageBase64","split","storeId","console","log","data","error","_x","apply","arguments","container","handleClick","event","preventDefault","imageSrc","getScreenshot","sequence","timing","toValue","duration","useNativeDriver","start","containerElement","addEventListener","removeEventListener","ref","style","styles","children","audio","screenshotFormat","videoConstraints","facingMode","width","ideal","get","height","webcam","flashOverlay","opacity","create","flex","position","objectFit","top","left","right","bottom","backgroundColor","zIndex"],"sources":["/Users/dankupfer/Documents/dev/shopping/shopping/ShoppingClient/src/components/WebCameraCapture.tsx"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport { View, Animated, StyleSheet, Dimensions, Platform } from 'react-native';\nimport Webcam from 'react-webcam';\nimport axios from 'axios';\n\ninterface WebCameraCaptureProps {}\n\nconst WebCameraCapture: React.FC<WebCameraCaptureProps> = () => {\n  const webcamRef = useRef<Webcam>(null);\n  const containerRef = useRef<View>(null);\n  const flashOpacity = useRef(new Animated.Value(0)).current;\n\n  const uploadImage = async (base64Image: string) => {\n    try {\n      const response = await axios.post('http://localhost:8080/api/price-tag/ocr', {\n        imageBase64: base64Image.split(',')[1], // Remove data URL prefix\n        storeId: 'your-store-id-here'\n      });\n\n      console.log('Upload response:', response.data);\n    } catch (error) {\n      console.error('Image upload error:', error);\n    }\n  };\n\n  useEffect(() => {\n    const container = containerRef.current;\n    \n    const handleClick = (event: MouseEvent) => {\n      event.preventDefault();\n      \n      if (webcamRef.current) {\n        const imageSrc = webcamRef.current.getScreenshot();\n        \n        if (imageSrc) {\n          // Upload image to server\n          uploadImage(imageSrc);\n\n          // Trigger flash animation\n          Animated.sequence([\n            Animated.timing(flashOpacity, {\n              toValue: 1,\n              duration: 250,\n              useNativeDriver: true\n            }),\n            Animated.timing(flashOpacity, {\n              toValue: 0,\n              duration: 250,\n              useNativeDriver: true\n            })\n          ]).start();\n        }\n      }\n    };\n\n    // Use addEventListener for web-specific click handling\n    const containerElement = containerRef.current as unknown as HTMLDivElement;\n    containerElement?.addEventListener('click', handleClick);\n\n    return () => {\n      containerElement?.removeEventListener('click', handleClick);\n    };\n  }, []);\n\n  return (\n    <View \n      ref={containerRef}\n      style={styles.container}\n    >\n      <Webcam\n        audio={false}\n        ref={webcamRef}\n        screenshotFormat=\"image/jpeg\"\n        videoConstraints={{\n          facingMode: \"environment\",\n          width: { ideal: Dimensions.get('window').height },\n          height: { ideal: Dimensions.get('window').width }\n        }}\n        style={styles.webcam}\n      />\n      \n      <Animated.View \n        style={[\n          styles.flashOverlay, \n          { \n            opacity: flashOpacity,\n          }\n        ]} \n      />\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    position: 'relative',\n  },\n  webcam: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'cover' as any,\n  },\n  flashOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'white',\n    zIndex: 10,\n  },\n});\n\nexport default WebCameraCapture;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}