{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport axios from \"axios\";\nimport WebCameraCapture from \"./WebCameraCapture\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar PriceTagCapture = function PriceTagCapture() {\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isLoading = _useState2[0],\n    setIsLoading = _useState2[1];\n  var uploadImage = function () {\n    var _ref = _asyncToGenerator(function* (base64Image) {\n      console.log('Base64 Image Length:', base64Image.length);\n      console.log('Base64 Image Prefix:', base64Image.slice(0, 50));\n      var cleanBase64 = base64Image.includes(',') ? base64Image.split(',')[1] : base64Image;\n      console.log('Clean Base64 Length:', cleanBase64.length);\n      setIsLoading(true);\n      try {\n        var response = yield axios.post('http://localhost:8080/api/price-tag/ocr', {\n          imageBase64: cleanBase64,\n          storeId: 'your-store-id-here'\n        }, {\n          validateStatus: function validateStatus(status) {\n            return status >= 200 && status < 300;\n          }\n        });\n      } catch (error) {\n        if (axios.isAxiosError(error)) {\n          var _error$response, _error$response2, _error$response3, _error$response4, _error$response4$data;\n          console.error('Detailed Axios Error:', {\n            response: (_error$response = error.response) == null ? void 0 : _error$response.data,\n            status: (_error$response2 = error.response) == null ? void 0 : _error$response2.status,\n            headers: (_error$response3 = error.response) == null ? void 0 : _error$response3.headers\n          });\n          Alert.alert('Upload Error', ((_error$response4 = error.response) == null ? void 0 : (_error$response4$data = _error$response4.data) == null ? void 0 : _error$response4$data.error) || 'Failed to upload image. Please try again.');\n        } else {\n          Alert.alert('Error', 'An unexpected error occurred. Please try again.');\n        }\n      } finally {\n        setIsLoading(false);\n      }\n    });\n    return function uploadImage(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  if (isLoading) {\n    return _jsx(View, {\n      style: styles.container,\n      children: _jsx(ActivityIndicator, {\n        size: \"large\",\n        color: \"#0000ff\"\n      })\n    });\n  }\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsx(WebCameraCapture, {\n      onCapture: uploadImage\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});\nexport default PriceTagCapture;","map":{"version":3,"names":["React","useState","View","StyleSheet","Alert","axios","WebCameraCapture","ActivityIndicator","jsx","_jsx","PriceTagCapture","_useState","_useState2","_slicedToArray","isLoading","setIsLoading","uploadImage","_ref","_asyncToGenerator","base64Image","console","log","length","slice","cleanBase64","includes","split","response","post","imageBase64","storeId","validateStatus","status","error","isAxiosError","_error$response","_error$response2","_error$response3","_error$response4","_error$response4$data","data","headers","alert","_x","apply","arguments","style","styles","container","children","size","color","onCapture","create","flex","justifyContent","alignItems"],"sources":["/Users/dankupfer/Documents/dev/shopping/shopping/ShoppingClient/src/components/PriceTagCapture.tsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { \n  View, \n  StyleSheet,\n  Alert\n} from \"react-native\";\nimport axios from \"axios\";\nimport WebCameraCapture from \"./WebCameraCapture\";\nimport { ActivityIndicator } from \"react-native\";\n\nconst PriceTagCapture: React.FC = () => {\n  const [isLoading, setIsLoading] = useState(false);\n\n  const uploadImage = async (base64Image: string) => {\n    // Log the full base64 image to check its format\n    console.log('Base64 Image Length:', base64Image.length);\n    console.log('Base64 Image Prefix:', base64Image.slice(0, 50));\n  \n    const cleanBase64 = base64Image.includes(',') \n      ? base64Image.split(',')[1] \n      : base64Image;\n  \n    console.log('Clean Base64 Length:', cleanBase64.length);\n  \n    setIsLoading(true);\n  \n    try {\n      const response = await axios.post('http://localhost:8080/api/price-tag/ocr', {\n        imageBase64: cleanBase64,\n        storeId: 'your-store-id-here'\n      }, {\n        // Add more detailed error handling\n        validateStatus: function (status) {\n          return status >= 200 && status < 300; // Default\n        }\n      });\n  \n      // Rest of the code remains the same...\n    } catch (error) {\n      if (axios.isAxiosError(error)) {\n        // Log more detailed error information\n        console.error('Detailed Axios Error:', {\n          response: error.response?.data,\n          status: error.response?.status,\n          headers: error.response?.headers\n        });\n  \n        Alert.alert(\n          'Upload Error', \n          error.response?.data?.error || 'Failed to upload image. Please try again.'\n        );\n      } else {\n        Alert.alert('Error', 'An unexpected error occurred. Please try again.');\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Render loading indicator if processing\n  if (isLoading) {\n    return (\n      <View style={styles.container}>\n        <ActivityIndicator size=\"large\" color=\"#0000ff\" />\n      </View>\n    );\n  }\n\n  return (\n    <View style={styles.container}>\n      <WebCameraCapture onCapture={uploadImage} />\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n});\n\nexport default PriceTagCapture;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}